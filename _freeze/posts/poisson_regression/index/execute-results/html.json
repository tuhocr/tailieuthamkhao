{
  "hash": "07e98ce6d4e680f7f0d5e2854b017369",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Tổng hợp tài liệu Poisson regression\"\nauthor: \"Duc Nguyen\"\ndate: last-modified\nlightbox: true\ncategories: [Poisson regression]\neditor_options: \n  chunk_output_type: console\n---\n\n\nHướng dẫn cách biện luận:\n\n* Poisson regression models [Playlist](https://www.youtube.com/playlist?list=PLzv58M2GAfm6OcHzm2h2UwYsxjghPTsv2)\n\n[Backup](http://book.thuviencanhan.com/ref/poisson_regression/video/)\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\ndf <- read_excel(\"E:/GITHUB/tailieuthamkhao/posts/poisson_regression/pois.xlsx\")\n\ndf <- as.data.frame(df)\n\nhead(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  GENDER AGE SUM_K\n1 FEMALE  22    78\n2   MALE  20     0\n3   MALE  20    40\n4   MALE  19    42\n5   MALE  20     0\n6 FEMALE  19    58\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\n\ndf |> dplyr:::group_by(GENDER) |> dplyr:::summarise(mean_AGE = mean(AGE),\n                                                    mean_SUM_K = mean(SUM_K),\n                                                    count = n())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 4\n  GENDER mean_AGE mean_SUM_K count\n  <chr>     <dbl>      <dbl> <int>\n1 FEMALE     19.3       35.4    88\n2 MALE       19.9       27.2    63\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf$SUM_K <- df$SUM_K + 1\n```\n:::\n\n\n**Vì có nhiều zero nên ta cần cộng thêm 1 để model dễ tính toán**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> dplyr:::group_by(GENDER) |> dplyr:::summarise(mean_AGE = mean(AGE),\n                                                    mean_SUM_K = mean(SUM_K),\n                                                    count = n())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 4\n  GENDER mean_AGE mean_SUM_K count\n  <chr>     <dbl>      <dbl> <int>\n1 FEMALE     19.3       36.4    88\n2 MALE       19.9       28.2    63\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfit <- glm(SUM_K ~ GENDER + AGE,\n           data = df,\n           family = \"poisson\")\n\nsummary(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = SUM_K ~ GENDER + AGE, family = \"poisson\", data = df)\n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  1.46369    0.24746   5.915 3.32e-09 ***\nGENDERMALE  -0.33307    0.03112 -10.703  < 2e-16 ***\nAGE          0.11037    0.01275   8.658  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 4004.5  on 150  degrees of freedom\nResidual deviance: 3852.7  on 148  degrees of freedom\nAIC: 4550.9\n\nNumber of Fisher Scoring iterations: 5\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(MASS)\ndf$SUM_K <- df$SUM_K + 1\nfit.nb <- glm.nb(SUM_K ~ GENDER + AGE,\n                 data = df) \n\nsummary(fit.nb)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm.nb(formula = SUM_K ~ GENDER + AGE, data = df, init.theta = 0.9955253049, \n    link = log)\n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)\n(Intercept)  1.55819    1.40250   1.111    0.267\nGENDERMALE  -0.28457    0.17420  -1.634    0.102\nAGE          0.10613    0.07255   1.463    0.143\n\n(Dispersion parameter for Negative Binomial(0.9955) family taken to be 1)\n\n    Null deviance: 174.85  on 150  degrees of freedom\nResidual deviance: 170.87  on 148  degrees of freedom\nAIC: 1375.4\n\nNumber of Fisher Scoring iterations: 1\n\n              Theta:  0.996 \n          Std. Err.:  0.109 \n\n 2 x log-likelihood:  -1367.416 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(stargazer)\n\nstargazer::stargazer(fit, \n                     fit.nb,\n                     type = \"text\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n==============================================\n                      Dependent variable:     \n                  ----------------------------\n                             SUM_K            \n                    Poisson       negative    \n                                  binomial    \n                      (1)           (2)       \n----------------------------------------------\nGENDERMALE         -0.333***       -0.285     \n                    (0.031)       (0.174)     \n                                              \nAGE                0.110***        0.106      \n                    (0.013)       (0.073)     \n                                              \nConstant           1.464***        1.558      \n                    (0.247)       (1.403)     \n                                              \n----------------------------------------------\nObservations          151           151       \nLog Likelihood    -2,272.439      -684.708    \ntheta                         0.996*** (0.109)\nAkaike Inf. Crit.  4,550.879     1,375.416    \n==============================================\nNote:              *p<0.1; **p<0.05; ***p<0.01\n```\n\n\n:::\n:::\n\n\n$$\\text{ln}(\\lambda (\\text{SUM\\_K})) = \\beta_0 + \\beta_1 \\text{GENDER} + \\beta_2 \\text{AGE}$$ \n\n**BIỆN LUẬN:**\n\n**`AGE` là biến liên tục**\n\nBiện luận cách 1: The coefficient of `AGE` is $0.11$. When the `AGE` increase 1 unit, the number `SUM_K` counts is expected to increase by a factor of $e^{0.11} = 1.116278$, all else equal (given the other variables are held constant in the model)\n\nBiện luận cách 2:  The coefficient for `AGE` is $0.11$. This means that the expected log count `SUM_K` for a one-unit increase in `AGE` is $0.11$. \n\nTiếng Việt: Hệ số của biến `ĐỘ TUỔI` là $0.11$. Khi `ĐỘ TUỔI` tăng 1 đơn vị, thì số đếm `SUM_K` tăng theo 1 tỷ lệ là $e^{0.11} = 1.116278$ đơn vị, trong trường hợp các biến còn lại là hằng số.\n\n\n**`GENDER` là biến phân loại, với `FEMALE` là reference**\n\nThis is the estimated Poisson regression coefficient comparing `MALE` to `FEMALE`, \n\nBiện luận cách 1: The coefficient of `MALE` is $-0.333$, are associated with a **decrease** in mean `SUM_K` by a factor of $e^{-0.333} = 0.7167$. That is, only 71.67% `SUM_K` in `MALE` than `FEMALE`.\n\nBiện luận cách 2: The difference in the logs of expected counts `SUM_K` is expected to be 0.333 unit **decrease** for `MALE` compared to `FEMALE`, while holding the other variables constant in the model.\n\nBiện luận cách 3: The indicator variable `GENDER` compares between `MALE` to `FEMALE`. The expected log count for `MALE` *decrease** by about $-0.333$\n\nTiếng Việt: Khi xét theo giới tính, thì `MALE` làm giảm trung bình `SUM_K` theo một tỷ lệ 0.7167 so với `FEMALE`. Hay nói cách khác, điểm số `SUM_K` của `MALE` thấp hơn `FEMALE`. \n\n\n`https://stats.oarc.ucla.edu/r/dae/poisson-regression/`\n\n`https://stats.oarc.ucla.edu/stata/output/poisson-regression/`\n\n`https://stats.oarc.ucla.edu/r/dae/zinb/`\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}